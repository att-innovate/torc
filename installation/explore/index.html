<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://att-innovate.github.io/torc/installation/explore/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Explore ToRC Services - ToRC</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-80815593-1', 'Github');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">ToRC</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Installation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../installation/">Overview</a>
</li>

                    
                        
<li >
    <a href="../wedge/">Provision Wedge</a>
</li>

                    
                        
<li >
    <a href="../snaproute/">Configure SnapRoute</a>
</li>

                    
                        
<li >
    <a href="../torc-core/">Install ToRC Core</a>
</li>

                    
                        
<li >
    <a href="../compute/">Provision Compute Node</a>
</li>

                    
                        
<li >
    <a href="../scheduler/">Restart Scheduler</a>
</li>

                    
                        
<li class="active">
    <a href="./">Explore ToRC Services</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Example <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../example/dns/">DNS Infrastructure</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../reference/">Reference</a>
                </li>
            
            
            
                <li >
                    <a href="../../construction/">Construction Sites</a>
                </li>
            
            
            
                <li >
                    <a href="../../softwarehardware/">Software / Hardware</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../about/team/">Team</a>
</li>

                    
                        
<li >
    <a href="../../about/license/">License</a>
</li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i>
                    </a>
                </li>
                <li >
                    <a rel="next" href="../scheduler/">
                        <i class="fa fa-arrow-left"></i>
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../../example/dns/">
                        <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#explore-torc-services">Explore ToRC Services</a></li>
        
            <li><a href="#mesos">Mesos</a></li>
        
            <li><a href="#dns-consul">DNS / Consul</a></li>
        
            <li><a href="#etcd-statesync">etcd / statesync</a></li>
        
            <li><a href="#performance-copilot-vector">Performance CoPilot / Vector</a></li>
        
            <li><a href="#influxdb-datacollector">InfluxDB / datacollector</a></li>
        
            <li><a href="#torc-scheduler">ToRC Scheduler</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="explore-torc-services">Explore ToRC Services</h1>
<p>Let’s explore the ToRC Core Services and its functions. </p>
<h2 id="mesos"><a href="https://mesos.apache.org">Mesos</a></h2>
<p>Mesos serves as the main resource manager for our rack. It also provides Admin-UIs for resource-usage of:</p>
<h4 id="running-tasks"><a href="http://wedge:5050/#/">Running Tasks</a></h4>
<p><img alt="mesos-all-tasks" src="../../assets/mesos-all-tasks.png" /></p>
<h4 id="active-frameworksschedulers-like-our-torc-scheduler"><a href="http://wedge:5050/#/frameworks">Active Frameworks/Schedulers</a>, like our ToRC Scheduler</h4>
<p><img alt="mesos-frameworks" src="../../assets/mesos-frameworks.png" /></p>
<h4 id="connected-slaves"><a href="http://wedge:5050/#/slaves">Connected Slaves</a></h4>
<p><img alt="mesos-all-slaves" src="../../assets/mesos-all-slaves.png" /></p>
<h2 id="dns-consul">DNS / <a href="https://www.consul.io">Consul</a></h2>
<p>The DNS service contains a regular bind9 service responsible for the nodes in our <code>homer.ave</code> domain, and the Consul service, which handles all the lookups for all the containers, services in the <code>service.torc</code> domain, like <code>etcd.service.torc</code>.</p>
<p>The <a href="http://wedge:8500/ui/#/dc1/nodes/wedge">Consul Admin UI</a> offers a list of all know services in the service domain.</p>
<p><img alt="consul-services" src="../../assets/consul-services.png" /></p>
<p>If you ssh in to one of the compute nodes you should now be able to ping ToRC related services and nodes:</p>
<pre><code>bladerunner@bladerunner1:~$ ping wedge.homer.ave
bladerunner@bladerunner1:~$ ping etcd.service.torc
</code></pre>
<h2 id="etcd-statesync"><a href="https://github.com/coreos/etcd">etcd</a> / <a href="https://github.com/att-innovate/torc_statesync">statesync</a></h2>
<p>etcd serves as our <em>state-soup</em>. It provides a unified view across the operational state of containers, machine, and network.</p>
<p>statesync constantly collects data from the network agent and the ToRC Scheduler and pushes it to etcd.</p>
<p>etcd also gets used by Docker and Calico to share network configuration across all the compute nodes.</p>
<p>The <a href="https://github.com/henszey/etcd-browser">etcd-browser</a> provides a UI to inspect the data stored in etcd.</p>
<p><img alt="etcd-browser" src="../../assets/etcd-browser.png" /></p>
<p>Query ToRC’s etcd at <a href="http://wedge:8000">http://wedge:8000</a></p>
<h2 id="performance-copilot-vector"><a href="http://www.pcp.io">Performance CoPilot</a> / <a href="https://github.com/Netflix/vector">Vector</a></h2>
<p>Performance CoPilot (pcp) collects and provides access to system metrics for hosts and containers. Each of the machines including the wedge have a pcp agent running to collect those metrics.</p>
<p>Vector is a performance monitoring UI which provides access to different metrics served by the pcp agents on each machine.</p>
<p><img alt="vector" src="../../assets/vector.png" /></p>
<p>The default dashboards for:</p>
<ul>
<li><a href="http://wedge:9091/#/?widgets=kernel.all.cpu,kernel.percpu.cpu,kernel.all.runnable,kernel.all.load,network.interface.bytes,network.tcpconn,network.interface.packets,network.tcp.retrans,mem,mem.vmstat.pgfault,kernel.all.pswitch,disk.iops,disk.bytes,disk.dev.avactive,disk.dev.latency&amp;host=wedge&amp;hostspec=localhost">wedge</a></li>
<li><a href="http://wedge:9091/#/?widgets=kernel.all.cpu,kernel.percpu.cpu,kernel.all.runnable,kernel.all.load,network.interface.bytes,network.tcpconn,network.interface.packets,network.tcp.retrans,mem,mem.vmstat.pgfault,kernel.all.pswitch,disk.iops,disk.bytes,disk.dev.avactive,disk.dev.latency&amp;host=bladerunner1&amp;hostspec=localhost">bladerunner1</a></li>
<li><a href="http://wedge:9091/#/?widgets=kernel.all.cpu,kernel.percpu.cpu,kernel.all.runnable,kernel.all.load,network.interface.bytes,network.tcpconn,network.interface.packets,network.tcp.retrans,mem,mem.vmstat.pgfault,kernel.all.pswitch,disk.iops,disk.bytes,disk.dev.avactive,disk.dev.latency&amp;host=bladerunner2&amp;hostspec=localhost">bladerunner2</a></li>
<li><a href="http://wedge:9091/#/?widgets=kernel.all.cpu,kernel.percpu.cpu,kernel.all.runnable,kernel.all.load,network.interface.bytes,network.tcpconn,network.interface.packets,network.tcp.retrans,mem,mem.vmstat.pgfault,kernel.all.pswitch,disk.iops,disk.bytes,disk.dev.avactive,disk.dev.latency&amp;host=bladerunner3&amp;hostspec=localhost">bladerunner3</a></li>
<li><a href="http://wedge:9091/#/?widgets=kernel.all.cpu,kernel.percpu.cpu,kernel.all.runnable,kernel.all.load,network.interface.bytes,network.tcpconn,network.interface.packets,network.tcp.retrans,mem,mem.vmstat.pgfault,kernel.all.pswitch,disk.iops,disk.bytes,disk.dev.avactive,disk.dev.latency&amp;host=bladerunner4&amp;hostspec=localhost">bladerunner4</a></li>
</ul>
<h2 id="influxdb-datacollector"><a href="https://influxdata.com">InfluxDB</a> / <a href="https://github.com/att-innovate/charmander-datacollector.git">datacollector</a></h2>
<p>We use InfluxDB as our time-series database. The datacollector agent constantly pulls a defined set of machine and container related metrics and stores them in InfluxDB.</p>
<p>Those time series can be used for scaling decisions, to detect anomalies, or any other automated optimization. Please check out our <a href="../../example/dns/">DNS Example</a>. </p>
<p>Important: We use an older version of InfluxDB, <strong>v0.8.8</strong>. We haven’t upgraded yet because of major breaking changes in their API.</p>
<p>InfluxDB offers a UI to query and visualize the stored metrics.</p>
<p><img alt="influxdb" src="../../assets/influxdb-cpu.png" /></p>
<p>In our <a href="../installation/">demo setup</a> we run InfluxDB on <code>bladerunner3</code> with username <em>root</em> and password <em>root</em>, and the name of our database name is <em>torc</em>.</p>
<p>Login at: <a href="http://bladerunner3:8083">http://bladerunner3:8083</a> and select <code>Explore Data</code> for the <code>torc</code> database.</p>
<p>Some Sample Queries:</p>
<pre><code>list series

select * from machine where hostname = 'bladerunner1' limit 1000

select * from network where hostname = 'bladerunner1' and interface_name = 'p2p2' limit 1000
</code></pre>
<h2 id="torc-scheduler"><a href="https://github.com/att-innovate/torc_scheduler">ToRC Scheduler</a></h2>
<p>The ToRC Scheduler is responsible for starting and supervising all these core services. It also serves as the endpoint for all the sub-schedulers, for example the <a href="https://github.com/att-innovate/torc_dns_scheduler">DNS-Scheduler</a>.</p>
<p>The ToRC Scheduler offers some status pages in json. Btw, a browser extensions like <a href="https://jsonview.com">JSONView</a> helps in formatting the output in a more human-readable way.</p>
<ul>
<li>List Services: <a href="http://wedge:3000/services/running">http://wedge:3000/services/running</a></li>
<li>List Compute Nodes: <a href="http://wedge:3000/nodes">http://wedge:3000/nodes</a> </li>
</ul>
<p>Next: <a href="../../example/dns/">DNS Scheduler Example</a>. </p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>© 2016 AT&T All Rights Reserved.</center>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>